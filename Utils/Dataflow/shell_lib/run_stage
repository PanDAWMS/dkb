run_stage() {
  [ -z "$1" ] \
    && { log ERROR "run_stage(): no stage ID passed."; exit 1; }
  cmd=cmd_${1}
  [ -z "${!cmd}" ] \
    && { log ERROR "run_stage(): stage not defined (ID: $1)."; exit 2; }

  [ -n "$DEBUG" ] \
    && { out="$1.out"; inp="$1.inp"; } \
    || { out=""; inp=""; }

  # 0 \
  # | 1 \
  # | 2
  tee $inp \
    | ${!cmd} \
    | tee $out

  # return the command execution status, not `tee`'s
  return "${PIPESTATUS[1]}"
}
