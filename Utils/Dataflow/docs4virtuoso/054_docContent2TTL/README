=============
* Stage 54  *
=============

1. Description
--------------
Transformation of document metadata, extracted at Stage 30 (PDFAnalyzer), into
TTL and SPARQL formats, appropriate to upload data into Virtuoso.

Each Document has Content. In the Ontology class Document has subclass
DocumentContent.

Each Document has IRI in Ontology <RESOURCE_GRAPH/document/{documentID}>

	Current default settings:
		ONTOLOGY      : http://nosql.tpu.ru/ontology/ATLAS
		RESOURCE_GRAPH: http://nosql.tpu.ru:8890/DAV/ATLAS

{documentID} is generated by pyDKB.dataflow.dkbID() function on the early
stages and passed to the downstream stages in JSON as "dkbID" field.

In general for each Document Content we must create instance in ontology as TTL
string:
{{{
<RESOURCE_GRAPH/document/{documentID}/{content_name}>
                                                 a <ONTOLOGY#DocumentContent> .
}}}

and connect it with the corresponding Document instance:
{{{
<RESOURCE_GRAPH/document/{documentID}> <ONTOLOGY#hasContent>
                        <RESOURCE_GRAPH/document/{documentID}/{content_name}> .
}}}

Document name example: "ATL-PHYS-2015"
Generated dkbID will look like "CDS_ATL-PHYS-2015".

For "content" in JSON file: 

- content.montecarlo_datasets -> [list of datasets]

    - create DocumnentContent instance TTL:
      {{{
      <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/montecarlo_datasets>
                                                 a <ONTOLOGY#DocumentContent> .
      }}}

    - associate DocumnentContent instance with Document instance:
      {{{
      <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015> <ONTOLOGY#hasContent>
              <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/montecarlo_datasets> .
      }}}

      for each element in the list of datasample names:

      - create data sample instance:
        {{{
        <RESOURCE_GRAPH/datasample/mc10_7TeV.105863.pythiaContactInt_Lambda3_minus.merge.AOD.e574_s933_s946_r1831_r1700>
                                                      a <ONTOLOGY#DataSample> .
        }}}

      - and associate this data sample with DocumentContent:
        {{{
        <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/montecarlo_datasets>
        <ONTOLOGY#mentionsDataSample>
        <RESOURCE_GRAPH/datasample/mc10_7TeV.105863.pythiaContactInt_Lambda3_minus.merge.AOD.e574_s933_s946_r1831_r1700>. 
        }}}
    
- the same for :
	content.group_datasets
	content.user_datasets
	content.physcont_datasets
	content.calibration_datasets
	content.realdata_datasets
	content.database_datasets
(in case if they are in JSON file)

- content.plain_text

    - create DocumentContent instance:
      {{{
      <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/plain_text>
                                                 a <ONTOLOGY#DocumentContent> .
      }}}

    - associate DocumentContent instance with Document instance:
      {{{
      <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015> <ONTOLOGY#hasContent>
                                   <../document/CDS_ATL-PHYS-2015/plain_text> .
      }}}

    - and for attributes in plain_text:

      - data taking year:
        {{{
        <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/plain_text>
                                     <ONTOLOGY#mentionsDataTakingYear> "2010" .
        }}}

      - luminosity:  
        - create luminosity instance:
          {{{
          <RESOURCE_GRAPH/luminosity/{luminosity_value}>
                                                      a <ONTOLOGY#Luminosity> .
          }}}
    
        - associate luminosity instance with document content:
          {{{
          <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/plain_text>
          <ONTOLOGY#mentionsLuminosity>
                               <RESOURCE_GRAPH/luminosity/{luminosity_value}> .
          }}}

      - energy:
        Possible energy values are already stored in ontology as Individuals
        for the class Energy (subclass of ExperimentAttribute).
        For example, http://nosql.tpu.ru/ontology/ATLAS#13tev,
                     http://nosql.tpu.ru/ontology/ATLAS#15tev, etc.
        Energy value from JSON must be coordinated with the corresponding
        Energy Individual in ontology (mention the lowercase):
        {{{
        <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/plain_text>
                                  <ONTOLOGY#mentionsEnergy> <ONTOLOGY#{Xtev}> .
        }}}

      - campaigns (for each element in the list of campaigns):
        - create Campaign instance in ontology (lowercase):
          {{{
          <RESOURCE_GRAPH/campaign/{campaign_name}> a <ONTOLOGY#Campaign> .
          }}}

        - associate campaign instance with Document Content:
          {{{
          <RESOURCE_GRAPH/document/CDS_ATL-PHYS-2015/plain_text>
          <ONTOLOGY#mentionsCampaign> 
                                    <RESOURCE_GRAPH/campaign/{campaign_name}> .
          }}}


    - collisions and
    - possible years
        are not in our scope. 
